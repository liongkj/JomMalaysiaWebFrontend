@model IEnumerable<JomMalaysia.Presentation.Models.CategoryViewModel>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewData["Title"] = "Category List";
    Layout = "~/Views/Shared/_LayoutIndex.cshtml";

    if (TempData["Message"] != null)
    {

    }
}
<form id="studentForm" method="POST">
    <div class="col-md-12 col-sm-12 no-padding" style="overflow-x:auto !important">
        <table id="tableData" class="table table-hover">
            <!--remain id as this, else change name in _LayoutIndex too-->
            <thead class="table-primary">

                <tr class="text-center">
                    <th scope="col">Category Code</th>
                    <th scope="col">Category Name</th>
                    <th scope="col">Category Name Ms</th>
                    <th scope="col">Category Name Zh</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody>
                @{ var count = 0; }

                @foreach (var item in Model)
                {

                    <tr>
                        <td>@item.CategoryCode</td>
                        <td>@item.CategoryName <span class="badge badge-dark">@(item.LstSubCategory == null ? 0 : item.LstSubCategory.Count) Subcategory</span></td>
                        <td>@item.CategoryNameMs</td>
                        <td>@item.CategoryNameZh</td>
                        <td>
                            <a href='@Url.Action("Index", "Home")' class=''></a>

                            <a href="@Url.Action("Edit", "Category", new { CategoryName = item.CategoryName })" class="btn btn-info col-md-5">
                                <span>
                                    <strong>Edit</strong>
                                </span>
                            </a>
                            <input onclick="deleteCategory('@item.CategoryId')" id="btnDelete" type="button" value="Delete" />
                            @*<button onclick="testswal(@item.CategoryId, count)">Delete</button>
                                <a href="@Url.Action("Delete", "Category", new { CategoryId = item.CategoryId })" id="btnDelete" class="btn btn-danger col-md-5 offset-md-1">
                                        <span>
                                            <strong>Delete</strong>
                                        </span>
                                    </a>*@
                        </td>
                    </tr>

                    count += 1;
                }

            </tbody>
        </table>
    </div>
</form>

<!--Confirm Delete Modal-->
<!-- <div id="modal-delete" class="modal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Confirm Delete?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary">Yes</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
            </div>
        </div>
    </div>
</div> -->
<!--Other Commmon Scripts are in _LayoutIndex.cshtml-->

@section SpecificScripts{

    <script type="text/javascript">

       
           function deleteCategory(catId)  
{  
          
        swal({  
                title: "Are you sure?",  
                text: "Are you sure that you want to delete this Order?",  
                type: "warning",  
                showCancelButton: true,  
                closeOnConfirm: false,  
                confirmButtonText: "Yes, delete it!",  
                confirmButtonColor: "#ec6c62"  
            },  
            function()   
             {  
                $.ajax({  
                    //TODO add [ValidateAntiForgeryToken]
                        url: "/Category/ConfirmDelete/",  
                        data:  {  
                            "CategoryId": catId  
                        },  
                        type: "POST",
                        success:(function(data)   
                            {
                              sweetAlert({  
                                title: "Deleted!",  
                                text: "Your file was successfully deleted!",  
                                type: "success"  
                            },  
                                function()  {  
                                    window.location.href = '/category';  
                                });  
                        }),error:  (function(data)  
                            {  
                                swal("Oops", "An error occur!", "error");  
                            })
                    })       
            });  
    }  
      
    </script>
}
